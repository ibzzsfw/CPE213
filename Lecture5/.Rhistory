distinct()
install.packages('corrplot')
head(rel, 6)
rel <- inner_join(a, d, v, by='movie_id') %>%
distinct()
rel <- inner_join(d, v, by='movie_id') %>%
distinct()
rel <- inner_join(rel, a, by='movie_id') %>%
distinct()
head(rel, 6)
ggqqplot(rel$duration, ylab = "duration")
rel %>%
sample_frac(1) %>%
ggscatter(x = "age", y = "views", size = 1,
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "Age of Movie", ylab = "Views")
library(corrplot)
corrplot(rel,
type = "upper", order = "hclust", tl.col = "black", tl.srt = 45)
res <- cor(rel)
res <- cor(rel$views, rel$age, rel$duration)
res <- cor(rel$views, rel$age, rel$duration)
res <- cor(rel$views, rel$age)
data(rel)
res <- rel %>%
select(views, age, duration) %>%
cor()
View(res)
res %>%
corrplot(res,
type = "upper", order = "hclust", tl.col = "black", tl.srt = 45)
res %>%
corrplot(type = "upper", order = "hclust", tl.col = "black", tl.srt = 45)
res %>%
corrplot()
res %>%
corrplot(type = "upper", tl.srt = 45)
res %>%
corrplot(type = "upper", order = "hclust", tl.col = "black", tl.srt = 45)
rel %>%
sample_frac(1) %>%
ggscatter(x = "age", y = "views", size = 1,
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "Age of Movie", ylab = "Views")
res %>%
corrplot(type = "upper", order = "hclust", tl.col = "black", tl.srt = 45)
res %>%
corrplot(methode = "number", type = "upper", order = "hclust", tl.col = "black", tl.srt = 45)
res %>%
corrplot(methode = "number")
corrplot(res, method = 'number')
corrplot(res, method = 'number', type = 'upper')
library(todyverse)
library(tidyverse)
data("mtcars")
force(mtcars)
d1=read.table("student-mat.csv",sep=";",header=TRUE)
d2=read.table("student-por.csv",sep=";",header=TRUE)
d3=merge(d1,d2,by=c("school","sex","age","address","famsize","Pstatus","Medu","Fedu","Mjob","Fjob","reason","nursery","internet"))
print(nrow(d3)) # 382 students
View(d1)
d1=read.table("student-mat.csv",sep=",",header=TRUE)
d2=read.table("student-por.csv",sep=",",header=TRUE)
d3=merge(d1,d2,by=c("school","sex","age","address","famsize","Pstatus","Medu","Fedu","Mjob","Fjob","reason","nursery","internet"))
print(nrow(d3)) # 382 students
head(d3, 6)
View(d1)
View(d3)
library(tidyverse)
d1 = read.csv("student-mat.csv")
d2 = read.csv("student-mat.csv")
d2 = read.csv("student-por.csv")
View(d1)
View(d2)
View(d1)
rel = merge(d1,d2,by=c("school","sex","age","address","famsize","Pstatus","Medu","Fedu","Mjob","Fjob","reason","nursery","internet"))
View(rel)
head(rel, 6)
rel = merge(d1,d2,by=c('school', 'sex', 'age', 'address', 'famsize', 'Pstatus', 'Medu', 'Fedu',
'Mjob', 'Fjob', 'reason', 'guardian', 'traveltime', 'studytime',
'failures', 'schoolsup', 'famsup', 'paid', 'activities', 'nursery',
'higher', 'internet', 'romantic', 'famrel', 'freetime', 'goout', 'Dalc',
'Walc', 'health', 'absences', 'G1', 'G2', 'G3'))
"school","sex","age","address","famsize","Pstatus","Medu","Fedu","Mjob","Fjob","reason","nursery","internet"))
d1 = read.csv("student-mat.csv")
d2 = read.csv("student-por.csv")
rel = merge(d1,d2,by=c("school","sex","age","address","famsize","Pstatus","Medu","Fedu","Mjob","Fjob","reason","nursery","internet"))
library(tidyverse)
library(eeptools)
library(ggpubr)
library(corrplot)
netflix <- read.csv('netflix.csv')
netflix <- netflix %>%
distinct() %>%
drop_na() %>%
filter(duration > 0)
netflix %>%
mutate(datetime = as.Date(datetime)) %>%
mutate(release_date = as.Date(release_date)) %>%
filter(!is.na(release_date)&!is.na(datetime)) %>%
mutate(age = age_calc(dob = release_date, enddate = Sys.Date(), units = "years")) %>%
mutate(last_watch = age_calc(dob = datetime, enddate = Sys.Date(), units = "years")) %>%
mutate(age = age - last_watch) -> netflix
netflix %>%
group_by(movie_id) %>%
summarise(age = mean(age)) %>%
filter(age >= 0) -> a
netflix %>%
group_by(movie_id) %>%
summarise(views = n()) -> v
netflix %>%
group_by(movie_id) %>%
summarise(duration = mean(duration)) -> d
rel <- inner_join(d, v, by='movie_id') %>%
distinct()
rel <- inner_join(rel, a, by='movie_id') %>%
distinct()
chisq.test( table(rel$views, rel$age) )
cor.test(rel$views, rel$age,method = "pearson")
head(rel, 6)
cor(x, y, method = c("pearson", "spearman")) # r, p
res <- rel %>%
select(views, age, duration) %>%
cor()
corrplot(res, method = 'number', type = 'upper')
corrplot(res, order = 'AOE', addCoef.col = 'black', tl.pos = 'd',
cl.pos = 'n', col = COL2('PiYG'))
corrplot(res,type = 'upper', order = 'AOE', addCoef.col = 'black', tl.pos = 'd',
cl.pos = 'n', col = COL2('PiYG'))
View(d)
rel %>%
sample_frac(1) %>%
ggscatter(x = "age", y = "duration", size = 1,
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "Age of Movie", ylab = "Views")
ggqqplot(rel$duration, ylab = "duration")
head(netflix,5)
str(netflix)
str(rel)
head(rel, 5)
netflix %>%
group_by(movie_id) %>%
summarise(duration = median(duration)) -> d
rel <- inner_join(d, v, by='movie_id') %>%
distinct()
rel <- inner_join(rel, a, by='movie_id') %>%
distinct()
ggqqplot(rel$duration, ylab = "duration")
res <- rel %>%
select(views, age, duration) %>%
cor()
corrplot(res,type = 'upper', order = 'AOE', addCoef.col = 'black', tl.pos = 'd',
cl.pos = 'n', col = COL2('PiYG'))
netflix %>%
group_by(movie_id) %>%
summarise(med = median(duration)) -> med
rel <- inner_join(rel, med, by='movie_id') %>%
distinct()
res <- rel %>%
select(views, age, duration, med) %>%
cor()
corrplot(res,type = 'upper', order = 'AOE', addCoef.col = 'black', tl.pos = 'd',
cl.pos = 'n', col = COL2('PiYG'))
netflix %>%
group_by(movie_id) %>%
summarise(age = mean(age)) %>%
filter(age >= 0) -> a
netflix %>%
group_by(movie_id) %>%
summarise(views = n()) -> v
netflix %>%
group_by(movie_id) %>%
summarise(duration = mean(duration)) -> d
netflix %>%
group_by(movie_id) %>%
summarise(med = median(duration)) -> med
rel <- inner_join(d, v, by='movie_id') %>%
distinct()
rel <- inner_join(rel, a, by='movie_id') %>%
distinct()
rel <- inner_join(rel, med, by='movie_id') %>%
distinct()
res <- rel %>%
select(views, age, duration, med) %>%
cor()
corrplot(res,type = 'upper', order = 'AOE', addCoef.col = 'black', tl.pos = 'd',
cl.pos = 'n', col = COL2('PiYG'))
cor(rel$duration, rel$med method = c("pearson", "spearman")) # r, p
cor(rel$duration, rel$med, method = c("pearson", "spearman")) # r, p
cor(duration, med, method = c("pearson", "spearman")) # r, p
cor(rel$duration, rel$med, method = c("pearson")) # r, p
cor(rel$duration, rel$med, method = 'pearson')
cor(rel$duration, rel$med, method = 'pearson') # duration is mean
rel <- inner_join(d, v, by='movie_id') %>%
distinct()
rel <- inner_join(rel, a, by='movie_id') %>%
distinct()
head(rel, 6)
ggqqplot(rel$duration, ylab = "duration")
ggqqplot(rel$views, ylab = "views")
corrplot(res,type = 'upper', order = 'AOE', addCoef.col = 'black', tl.pos = 'd',
cl.pos = 'n', col = COL2('PiYG'))
res <- rel %>%
select(views, age, duration) %>%
cor()
corrplot(res,type = 'upper', order = 'AOE', addCoef.col = 'black', tl.pos = 'd',
cl.pos = 'n', col = COL2('PiYG'))
ggqqplot(rel$views, ylab = "views")
ggqqplot(rel$age, ylab = "age")
rel %>%
ggplot(aes(age)) + geom_density()
rel %>%
ggplot(aes(views)) + geom_density()
rel %>%
ggplot(aes(duration)) + geom_density()
corrplot(res,type = 'upper', order = 'AOE', addCoef.col = 'black', tl.pos = 'd',
cl.pos = 'n', col = COL2('PiYG'))
corrplot(res, p.mat = testRes$p, method = 'circle', type = 'lower', insig='blank',
addCoef.col ='black', number.cex = 0.8, order = 'AOE', diag=FALSE)
corrplot(res, method = 'circle', type = 'lower', insig='blank',
addCoef.col ='black', number.cex = 0.8, order = 'AOE', diag=FALSE)
corrplot(res, method = 'circle', type = 'upper', insig='blank',
addCoef.col ='black', number.cex = 0.8, order = 'AOE', diag=FALSE)
ggqqplot(rel$views, ylab = "views") + ggqqplot(rel$age, ylab = "age")
ggqqplot(rel$views, ylab = "views")
corrplot(res,type = 'upper', order = 'AOE', addCoef.col = 'black', tl.pos = 'd',
cl.pos = 'n', col = COL2('PiYG')) + coord_fixed()
ggqqplot(rel$views, ylab = "views") + coord_fixed()
ggqqplot(rel$views, ylab = "views") + coord_fixed(1)
ggqqplot(rel$views, ylab = "views") + coord_fixed(2)
ggqqplot(rel$views, ylab = "views") + coord_fixed(1,1)
ggqqplot(rel$views, ylab = "views")
ggqqplot(rel$views, ylab = "views") + theme(aspect.ratio=1)
netflix <- read.csv('netflix.csv')
netflix <- netflix %>%
distinct() %>%
drop_na() %>%
filter(duration > 0)
today <- Sys.Date()
netflix %>%
mutate(datetime = as.Date(datetime)) %>%
mutate(release_date = as.Date(release_date)) %>%
filter(!is.na(release_date)&!is.na(datetime)) %>%
mutate(age = age_calc(dob = release_date, enddate = today, units = "years")) %>%
mutate(last_watch = age_calc(dob = datetime, enddate = today, units = "years")) %>%
mutate(age = age - last_watch) -> netflix
netflix <- read.csv('netflix.csv')
today <- Sys.Date()
netflix %>%
mutate(datetime = as.Date(datetime)) %>%
mutate(release_date = as.Date(release_date)) %>%
filter(!is.na(release_date)&!is.na(datetime)) %>%
mutate(age = age_calc(dob = release_date, enddate = today, units = "years")) %>%
mutate(last_watch = age_calc(dob = datetime, enddate = today, units = "years")) %>%
mutate(age = age - last_watch) -> netflix
netflix %>%
group_by(movie_id) %>%
summarise(age = mean(age))
netflix %>%
group_by(movie_id) %>%
summarise(age = mean(age)) -> a
View(a)
netflix %>%
group_by(movie_id) %>%
summarise(age = mean(age)) %>%
filter(age >= 0) -> a
netflix %>%
group_by(movie_id) %>%
summarise(views = n()) -> v
netflix %>%
group_by(movie_id) %>%
summarise(duration = mean(duration)) -> d
netflix %>%
group_by(movie_id) %>%
summarise(med = median(duration)) -> med
rel <- inner_join(d, v, by='movie_id') %>%
distinct()
rel <- inner_join(rel, a, by='movie_id') %>%
distinct()
res <- rel %>%
select(views, age, duration) %>%
cor()
rel %>%
sample_frac(1) %>%
ggscatter(x = "views", y = "duration", size = 1,
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "Age of Movie", ylab = "Views")
rel %>%
sample_frac(1) %>%
ggplot(aes(x=age, y=views)) +
geom_smooth()
ggscatter(x = "age", y = "duration", size = 1,
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "Age of Movie", ylab = "Views")
rel %>%
sample_frac(1) %>%
ggscatter(x = "age", y = "duration", size = 1,
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "Age of Movie", ylab = "Views")
rel %>%
sample_frac(1) %>%
ggscatter(x = age, y = views, size = 1,
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "Age of Movie", ylab = "Views")
rel %>%
sample_frac(1) %>%
ggscatter(x = 'age', y = 'views', size = 1,
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "Age of Movie", ylab = "Views")
cor.test(res$views, res$age,
method = "pearson")
library(tidyverse)
library(eeptools)
library(ggpubr)
library(corrplot)
cor(rel$duration, rel$med, method = 'pearson')
cor.test(rel$views, rel$age, method = "pearson")
corrplot(res,type = 'upper', order = 'AOE', addCoef.col = 'black', tl.pos = 'd',
cl.pos = 'n', col = COL2('PiYG'))
View(res)
cor.test(rel$views, rel$age, method = "pearson")
rel %>%
sample_frac(1) %>%
ggscatter(x = 'age', y = 'duration', size = 1,
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "Age of Movie", ylab = "Views")
cor.test(rel$views, rel$duration, method = "pearson")
cor.test(rel$age, rel$duration, method = "pearson")
rel %>%
sample_frac(1) %>%
ggscatter(x = 'age', y = 'duration', size = 1,
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "Age of Movie", ylab = "Views")
rel %>%
sample_frac(1) %>%
ggscatter(age ~ duration, size = 1,
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "Age of Movie", ylab = "Views")
scatterplot(age ~ duration, data = rel,
smoother = FALSE, grid = FALSE, frame = FALSE)
install.packages('scatterplot')
library(scatterplot)
scatterplot(age ~ duration, data = rel,
smoother = FALSE, grid = FALSE, frame = FALSE)
install.packages("car")
install.packages("car")
library(car)
library('car')
scatterplot(age ~ duration, data = rel,
smoother = FALSE, grid = FALSE, frame = FALSE)
scatterplot(duration~age, data = rel,
smoother = FALSE, grid = FALSE, frame = FALSE)
scatterplot(duration ~ age, data = rel,
smoother = FALSE, grid = FALSE, frame = FALSE)
scatterplot(views ~ age, data = rel,
smoother = FALSE, grid = FALSE, frame = FALSE)
scatterplot(views ~ age, data = rel,
smoother = FALSE, grid = FALSE, frame = FALSE)
plot(rel$views, rel$age, main = "Main title",
xlab = "X axis title", ylab = "Y axis title",
pch = 19, frame = FALSE)
plot(rel$views, rel$age, main = "Main title",
xlab = "X axis title", ylab = "Y axis title",
pch = 1, frame = FALSE)
plot(rel$views, rel$age, main = "views ~ age",
xlab = "Age", ylab = "Views",
pch = 1, frame = FALSE)
abline(lm(rel$views, rel$age, data = rel), col = "blue")
abline(lm(views, age, data = rel), col = "blue")
abline(lm(views~age, data = rel), col = "blue")
plot(rel$age, rel$views, main = "views ~ age",
xlab = "Age", ylab = "Views",
pch = 1, frame = FALSE)
abline(lm(views~age, data = rel), col = "blue")
plot(rel$age, rel$views, main = "views ~ age",
xlab = "Age", ylab = "Views",
pch = 0.5, frame = FALSE)
plot(rel$age, rel$views, main = "views ~ age",
xlab = "Age", ylab = "Views",
pch = 1, frame = FALSE)
abline(lm(views~age, data = rel), col = "blue")
scatterplot(duration ~ age, data = rel,
smoother = FALSE, grid = FALSE, frame = FALSE)
abline(lm(duration~age, data = rel), col = "blue")
abline(lm(duration~age, data = rel), col = "blue")
rel %>%
ggplot(aes(x=age, y=views)) +
geom_point()
abline(lm(duration~age, data = rel), col = "blue")
plot(rel$age, rel$duration, main = "duration ~ age",
xlab = "Age", ylab = "Views",
pch = 1, frame = FALSE)
plot(rel$age, rel$duration, main = "duration ~ age",
xlab = "Age", ylab = "Duration",
pch = 1, frame = FALSE)
abline(lm(duration~age, data = rel), col = "blue")
library(tidyverse)
library(eeptools)
library(ggpubr)
library(corrplot)
library('car')
n <- read.csv('netflix.csv')
n <- n %>%
distinct() %>%
drop_na()
s <- strsplit(netflix$genres, split = ", ")
movie <- data.frame(movie_id = rep(netflix$movie_id, sapply(s, length)), genres = unlist(s))
n %>%
mutate(watch = if_else(duration==0, 'no', 'yes'))
s <- strsplit(n$genres, split = ", ")
movie <- data.frame(movie_id = rep(n$movie_id, sapply(s, length)), genres = unlist(s))
movie <- data.frame(X = rep(n$X, sapply(s, length)), genres = unlist(s))
n %>%
select(X, watch) -> w
n %>%
mutate(watch = if_else(duration==0, 'no', 'yes')) %>%
select(X, watch) -> w
full_join(n, s, by='X')
merge(w, s[, c("X", "watch", "genres")], by="X")
merge(w, s[, c("watch", "genres")], by="X")
merge(w, s, [c("X", "watch", "genres")], by="X")
merge(w, s[c("X", "genres")], by="X")
merge(w, s[c("X", "genres")], by="X")
merge(w, s[, c("X", "genres")], by="X")
merge(w, movie[, c("X", "genres")], by="pid")
merge(w, movie[, c("X", "genres")], by="X")
rel <- merge(w, movie[, c("X", "genres")], by="X")
rel %>%
ggplot(aes(x = genres, fill = watch)) +
geom_bar(position = "fill")
chisq.test( table(rel$genres,
rel$watch) )
chisq.test( table(rel$genres, rel$watch) )
netflix %>%
group_by(release_date) %>%
summarise(n = n())
netflix %>%
group_by(release_date) %>%
summarise(n = n()) %>%
ggplot(aes(x=release_date,y=n)) +
geom_line()
netflix %>%
mutate(month = format(as.POSIXct(release_date),"%Y-%m")) %>%
group_by(month) %>%
summarise(n = n()) %>%
ggplot(aes(x=release_date,y=n)) +
geom_line()
netflix %>%
mutate(month = format(as.POSIXct(release_date),"%Y-%m")) %>%
group_by(month) %>%
summarise(n = n())
netflix %>%
mutate(month = format(as.POSIXct(release_date),"%Y-%m")) %>%
group_by(month) %>%
summarise(n = n()) -> month
library("zoo")
netflix %>%
mutate(month = as.yearmon(release_date, "%Y-%m")) %>%
group_by(month) %>%
summarise(n = n()) %>%
ggplot(aes(x=release_date,y=n)) +
geom_line()
netflix %>%
mutate(month = as.yearmon(release_date, "%Y-%m")) %>%
group_by(month) %>%
summarise(n = n()) %>%
ggplot(aes(x=month,y=n)) +
geom_line()
netflix %>%
select(movie_id, release_date) %>%
distinct() %>%
mutate(month = as.yearmon(release_date, "%Y-%m")) %>%
group_by(month) %>%
summarise(n = n()) %>%
ggplot(aes(x=month,y=n)) +
geom_line()
netflix %>%
select(movie_id, release_date) %>%
distinct() %>%
mutate(month = as.yearmon(release_date, "%Y-%m")) %>%
group_by(month) %>%
summarise(n = n())
netflix %>%
select(movie_id, release_date) %>%
distinct()
netflix %>%
select(movie_id, release_date) %>%
distinct() %>%
mutate(month = as.yearmon(release_date, "%Y-%m")) %>%
group_by(month) %>%
summarise(n = n()) %>%
ggplot(aes(x=month,y=n)) +
geom_line()
netflix %>%
select(movie_id, release_date) %>%
distinct() %>%
mutate(month = as.yearmon(release_date, "%Y-%m")) %>%
group_by(month) %>%
summarise(n = n()) %>%
ggplot(aes(x=month,y=n)) +
geom_col()
